<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RTOS 4: milestone4/timer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>milestone4/timer.c File Reference</h1>  </div>
</div>
<div class="contents">

<p>This file provides implementation support for timer interrupt handler. It is assumed that the CPU context of the current task is already saved, and will handle Sleep service support along with pre-emptive context switching.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="_r_t_o_s4_2rtos_8h_source.html">rtos.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_r_t_o_s4_2globals_8h_source.html">globals.h</a>&quot;</code><br/>

<p><a href="timer_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timer_8c.html#a40b22ba4c3696cb76717bbac4366618f">TimerSupport</a> (void)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This file provides implementation support for timer interrupt handler. It is assumed that the CPU context of the current task is already saved, and will handle Sleep service support along with pre-emptive context switching. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Ig Kolenko, Samuel Lewis, Adrian Hyde, Dan Evans, Hekar Khani</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Though many global variables are defined here, they may or may not be initialized here, so watch out! </dd></dl>

<p>Definition in file <a class="el" href="timer_8c_source.html">timer.c</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a40b22ba4c3696cb76717bbac4366618f"></a><!-- doxytag: member="timer.c::TimerSupport" ref="a40b22ba4c3696cb76717bbac4366618f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerSupport </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="timer_8c_source.html#l00030">30</a> of file <a class="el" href="timer_8c_source.html">timer.c</a>.</p>
<div class="fragment"><pre class="fragment">{
   <a class="code" href="structpdb.html">PDB</a> *p;

   <span class="comment">/*</span>
<span class="comment">    * first, locate all sleeping tasks, and adjust sleep counter</span>
<span class="comment">    * in an effort to wake up these tasks. We assume that the</span>
<span class="comment">    * SleepDuration member of the PDB holds a count of how many</span>
<span class="comment">    * timer interrupts should arrive before waking task up.</span>
<span class="comment">    */</span>

   p = <a class="code" href="globals_8c.html#a32c773383bd3fa3849068d16270b094f">pdb_First</a>;
   <span class="keywordflow">do</span> {
      <span class="keywordflow">if</span> (p-&gt;<a class="code" href="structpdb.html#aff97a87345038b6d69b0a6de1f6efdf5">Status</a> == <a class="code" href="milestone4_2rtos_8h.html#a48f6457243719e7031768d4100741159">BLOCKED</a>) {
         <span class="keywordflow">if</span> (p-&gt;<a class="code" href="structpdb.html#adfb03271058360f2433c7ac6837ffc57">Reason</a> == <a class="code" href="milestone4_2rtos_8h.html#ac2692565e36789f1a2d3767301bf21ca">REASON_SLEEP</a>) {
            p-&gt;<a class="code" href="structpdb.html#a0370837c3d36be2ec1076a19abb2239f">SleepDuration</a>--;
            <span class="keywordflow">if</span> (p-&gt;<a class="code" href="structpdb.html#a0370837c3d36be2ec1076a19abb2239f">SleepDuration</a> == 0) {
               p-&gt;<a class="code" href="structpdb.html#aff97a87345038b6d69b0a6de1f6efdf5">Status</a> = <a class="code" href="milestone4_2rtos_8h.html#ad1235d5ce36f7267285e82dccd428aa6">READY</a>;
               p-&gt;<a class="code" href="structpdb.html#adfb03271058360f2433c7ac6837ffc57">Reason</a> = <a class="code" href="milestone4_2rtos_8h.html#a9a4cd85aaac46206276db6ce20aec5bc">REASON_NONE</a>;
            }  <span class="comment">/* endif */</span>
         }  <span class="comment">/* endif */</span>
      }  <span class="comment">/* endif */</span>

      p = p-&gt;<a class="code" href="structpdb.html#ae4dd6c64c219b91ad0db44e343fe8fa1">NextPDB</a>;
   } <span class="keywordflow">while</span> (p != <a class="code" href="globals_8c.html#a32c773383bd3fa3849068d16270b094f">pdb_First</a>);

   <span class="comment">/*</span>
<span class="comment">    * now, preemptively schedule next task</span>
<span class="comment">    * using round robin scheduling</span>
<span class="comment">    */</span>

   <a class="code" href="milestone4_2rtos_8h.html#a26c5af6bb9bd7e1b4acc69cc24d3846f" title="Robin round scheduler.">RoundRobinScheduler</a>();

   <span class="comment">/*</span>
<span class="comment">    * increment our count of timer &quot;ticks&quot; so that we have</span>
<span class="comment">    * potential support for rudimentary timing (similar to</span>
<span class="comment">    * the Windows &quot;GetTickCount&quot; concept)</span>
<span class="comment">    */</span>
   ++<a class="code" href="globals_8c.html#a5092bbc9e04487b450e965e9ac6d9bec">gTickCount</a>;

   <span class="comment">/*</span>
<span class="comment">    * and that&#39;s all folks!</span>
<span class="comment">    */</span>

}  <span class="comment">/* end TimerSupport */</span>
</pre></div>
</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Dec 15 2010 09:49:12 for RTOS 4 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>

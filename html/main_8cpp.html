<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RTOS 4: RTOS4_Test/main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>RTOS4_Test/main.cpp File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="_r_t_o_s4_2stdlib_8h_source.html">stdlib.h</a>&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;malloc.h&gt;</code><br/>
<code>#include &lt;windows.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="global__const_8h_source.html">global_const.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="draw_8h_source.html">draw.h</a>&quot;</code><br/>
<code>#include &quot;../RTOS4/globals.h&quot;</code><br/>
<code>#include &quot;../RTOS4/rtos.h&quot;</code><br/>

<p><a href="main_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">LRESULT CALLBACK&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ac996a0edf7f6d6736f7f2920665a453d">WndProc</a> (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the Window Procedure for the main window of this application. It processes all messages destined for this main window.  <a href="#ac996a0edf7f6d6736f7f2920665a453d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int CALLBACK&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a52fc2721249e683aa03c13f8978eae1d">WinMain</a> (HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpszCmdParam, int nCmdShow)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="author"><dt><b>Author:</b></dt><dd>Hekar Khani, Samuel Lewis, Adrian Hyde, Dan Evans </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>December 14, 2010  Test application for RTOS Milestone 4. This application allows us to simulate the theoretical functions that Team #1 was designated with. Not all the functionality is in this Windows application. We saw that it was not a wise idea to do that. Those functions are in the Visual 68k simulation based project. </dd></dl>

<p>Definition in file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a52fc2721249e683aa03c13f8978eae1d"></a><!-- doxytag: member="main.cpp::WinMain" ref="a52fc2721249e683aa03c13f8978eae1d" args="(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpszCmdParam, int nCmdShow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CALLBACK WinMain </td>
          <td>(</td>
          <td class="paramtype">HINSTANCE&#160;</td>
          <td class="paramname"> <em>hInstance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HINSTANCE&#160;</td>
          <td class="paramname"> <em>hPrevInstance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPSTR&#160;</td>
          <td class="paramname"> <em>lpszCmdParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"> <em>nCmdShow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is the entry point for all Windows programs. It is informed of the current instance handle, the previous instance handle, the current commandline, and the show flag for how the window is to be displayed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">HINSTANCE</td><td>hInstance - Current instance of application </td></tr>
    <tr><td class="paramname">HINSTANCE</td><td>hPrevInstance - Previous instance of application </td></tr>
    <tr><td class="paramname">LPSTR</td><td>lpszCmdParam - Command line arguments </td></tr>
    <tr><td class="paramname">int</td><td>nCmdShow - Window state to show</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Operating system return code </dd></dl>

<p>Definition at line <a class="el" href="main_8cpp_source.html#l00058">58</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
        HWND hwnd;
        MSG msg;
        WNDCLASS wndclass;
        <span class="keywordtype">long</span> style;

        <span class="comment">// proceed with WNDCLASS registration</span>
        <span class="keywordflow">if</span> (!hPrevInstance) 
        {
                wndclass.style         = CS_HREDRAW | CS_VREDRAW;
                wndclass.lpfnWndProc   = <a class="code" href="main_8cpp.html#ac996a0edf7f6d6736f7f2920665a453d" title="This is the Window Procedure for the main window of this application. It processes all messages desti...">WndProc</a>;
                wndclass.cbClsExtra    = 0;
                wndclass.cbWndExtra    = 0;
                wndclass.hInstance     = hInstance;
                wndclass.hIcon         = LoadIcon (<a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
                wndclass.hCursor       = LoadCursor (<a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, IDC_ARROW);
                wndclass.hbrBackground = (HBRUSH)GetStockObject (WHITE_BRUSH);
                wndclass.lpszMenuName  = <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
                wndclass.lpszClassName = szAppName;
                RegisterClass (&amp;wndclass);
        }

        hInst = hInstance;

<span class="preprocessor">#ifdef UNDER_CE</span>
<span class="preprocessor"></span>        <span class="comment">// Different styling under Windows CE</span>
        style = WS_BORDER;
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        style = WS_OVERLAPPEDWINDOW;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="comment">// Create our main window</span>
        hwnd = CreateWindow (szAppName, szTitle, style, 
                CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, 
                <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, hInstance, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);

        <span class="comment">// Show our window</span>
        ShowWindow (hwnd, nCmdShow);
        UpdateWindow (hwnd);

        <span class="keywordflow">while</span> (GetMessage (&amp;msg, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0)) 
        {
                TranslateMessage (&amp;msg);
                DispatchMessage (&amp;msg);
        }

        <span class="keywordflow">return</span> msg.wParam;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac996a0edf7f6d6736f7f2920665a453d"></a><!-- doxytag: member="main.cpp::WndProc" ref="ac996a0edf7f6d6736f7f2920665a453d" args="(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LRESULT CALLBACK WndProc </td>
          <td>(</td>
          <td class="paramtype">HWND&#160;</td>
          <td class="paramname"> <em>hwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT&#160;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WPARAM&#160;</td>
          <td class="paramname"> <em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPARAM&#160;</td>
          <td class="paramname"> <em>lParam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is the Window Procedure for the main window of this application. It processes all messages destined for this main window. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">HWND</td><td>hwnd - Handle to window </td></tr>
    <tr><td class="paramname">UINT</td><td>message - Message identifier </td></tr>
    <tr><td class="paramname">WPARAM</td><td>wParam - wParam </td></tr>
    <tr><td class="paramname">LPARAM</td><td>lParam - lParam </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="main_8cpp_source.html#l00119">119</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
        PAINTSTRUCT ps;
        RECT bounds;
        HDC hdc;
        <a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html">RTOSTESTDATA</a> *pData;

        <span class="keywordflow">switch</span> (message)
        {
        <span class="keywordflow">case</span> WM_CREATE:
                <span class="comment">// Initialize the RT OS</span>
                <a class="code" href="osinit_8c.html#ab6198077782239b5f378eab25e4129d9">InitOS</a> ();

                pData = (<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html">RTOSTESTDATA</a> *)malloc (<span class="keyword">sizeof</span> (<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html">RTOSTESTDATA</a>));
                <span class="keywordflow">if</span> (pData == <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
                        <span class="keywordflow">return</span> -1;

                SetWindowLong (hwnd, GWL_USERDATA, (LONG)pData);

                <span class="comment">// Enable the serial debug output timer</span>
                SetTimer (hwnd, <a class="code" href="global__const_8h.html#a5495990a5f1b6839399e691a33d9f757ab6cfc839eb7b0c2dd591bd9aa7b7e224">IDT_INTERRUPT_DEBUG_OUT</a>, 100, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
                <span class="comment">// Enable the interrupt timer</span>
                SetTimer (hwnd, <a class="code" href="global__const_8h.html#a5495990a5f1b6839399e691a33d9f757a26ba5ac9a1a265fd892605a843734693">IDT_INTERRUPT_7</a>, 1000, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);

                <span class="comment">// Keyboard buffer is our default view</span>
                pData-&gt;<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html#ac6f993d4502b5f7b2ac71f06722e1cf3">CurrentView</a> = <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a1db1b1b71327c43334aa45028c21d8a5">VIEW_KEYBOARD_BUFFER</a>;

                <span class="comment">// Create our radio buttons for changing window panes</span>
                CreateWindow (<span class="stringliteral">&quot;BUTTON&quot;</span>, <a class="code" href="global__const_8h.html#a7cc843005ac83a4f284d403a4847337d">KEYBOARD_IN</a>, WS_CHILD | WS_VISIBLE | BS_AUTORADIOBUTTON, 
                        0, 0, <a class="code" href="global__const_8h.html#abc2f194da743c621f912efc97108db99">VIEW_BUTTON_SIZE</a>, 24, hwnd, (HMENU)<a class="code" href="global__const_8h.html#ac61efb76533bd87c354fffbe1a6e44e1afc6aa7a5b464208bcab0c3cfaa09fb6e">IDC_VIEW_KEYBOARD_BUFFER</a>, hInst, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
                CreateWindow (<span class="stringliteral">&quot;BUTTON&quot;</span>, <a class="code" href="global__const_8h.html#afd72ebd2ae30d0b5df68710f8d2d3e79">SERIAL_IN</a>, WS_CHILD | WS_VISIBLE | BS_AUTORADIOBUTTON, 
                        <a class="code" href="global__const_8h.html#abc2f194da743c621f912efc97108db99">VIEW_BUTTON_SIZE</a>, 0, <a class="code" href="global__const_8h.html#abc2f194da743c621f912efc97108db99">VIEW_BUTTON_SIZE</a>, 24, hwnd, (HMENU)<a class="code" href="global__const_8h.html#ac61efb76533bd87c354fffbe1a6e44e1aa74066286ed9641eab043fe075bb2c1d">IDC_VIEW_SERIAL_IN_BUFFER</a>, hInst, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
                CreateWindow (<span class="stringliteral">&quot;BUTTON&quot;</span>, <a class="code" href="global__const_8h.html#ae0574926323e06ec604473d7f03f2ffa">SERIAL_OUT</a>, WS_CHILD | WS_VISIBLE | BS_AUTORADIOBUTTON, 
                        <a class="code" href="global__const_8h.html#abc2f194da743c621f912efc97108db99">VIEW_BUTTON_SIZE</a> * 2, 0, <a class="code" href="global__const_8h.html#abc2f194da743c621f912efc97108db99">VIEW_BUTTON_SIZE</a>, 24, hwnd, (HMENU)<a class="code" href="global__const_8h.html#ac61efb76533bd87c354fffbe1a6e44e1a5db5a0630eb0374dd309eb646a759987">IDC_VIEW_SERIAL_OUT_BUFFER</a>, hInst, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
                CreateWindow (<span class="stringliteral">&quot;BUTTON&quot;</span>, <a class="code" href="global__const_8h.html#ac00c5fe00853dab2ff3d86ae62c83809">OTHER</a>, WS_CHILD | WS_VISIBLE | BS_AUTORADIOBUTTON, 
                        <a class="code" href="global__const_8h.html#abc2f194da743c621f912efc97108db99">VIEW_BUTTON_SIZE</a> * 3, 0, <a class="code" href="global__const_8h.html#abc2f194da743c621f912efc97108db99">VIEW_BUTTON_SIZE</a>, 24, hwnd, (HMENU)<a class="code" href="global__const_8h.html#ac61efb76533bd87c354fffbe1a6e44e1a0af8939378a9da321a1ee58758b2a474">IDC_VIEW_OTHER</a>, hInst, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);

                <span class="comment">// Keyboard buffer is our default view</span>
                CheckDlgButton (hwnd, <a class="code" href="global__const_8h.html#ac61efb76533bd87c354fffbe1a6e44e1afc6aa7a5b464208bcab0c3cfaa09fb6e">IDC_VIEW_KEYBOARD_BUFFER</a>, <a class="code" href="milestone4_2shared_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);

                <span class="keywordflow">return</span> 0;

        <span class="keywordflow">case</span> WM_PAINT:
        {
                pData = (<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html">RTOSTESTDATA</a> *)GetWindowLong (hwnd, GWL_USERDATA);
                <span class="keywordflow">if</span> (pData == <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
                        <span class="keywordflow">return</span> -1;

                GetClientRect (hwnd, &amp;bounds);

                hdc = BeginPaint (hwnd, &amp;ps);
                
                <span class="comment">// Draw each view differently depending on</span>
                <span class="comment">// what view state we&#39;re in</span>
                <span class="keywordflow">switch</span> (pData-&gt;<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html#ac6f993d4502b5f7b2ac71f06722e1cf3">CurrentView</a>)
                {
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a1db1b1b71327c43334aa45028c21d8a5">VIEW_KEYBOARD_BUFFER</a>:
                        DrawCircularBuffer &lt;short, unsigned char&gt; 
                                (hwnd, hdc, <a class="code" href="globals_8c.html#af55ddd969371f06ef9222afa9be50dae">keyboard_data</a>, <a class="code" href="globals_8c.html#a725e2b350bbcfdce56aadcf50020bd2a">keyboard_head</a>, <a class="code" href="globals_8c.html#a04b002df1014220cd0a9775b8da0b698">keyboard_tail</a>, ARRAYSIZE(keyboard_data), 0, 32, 32, 32);
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a2295642dfec0aeb91008f49d2b974740">VIEW_SERIAL_IN_BUFFER</a>:
                        DrawCircularBuffer &lt;short, unsigned char&gt; 
                                (hwnd, hdc, <a class="code" href="globals_8c.html#a9d355c13b2e81db96bfb18806613c2ad">serial_in_data</a>, <a class="code" href="globals_8c.html#a81c48d65c560b905241af82a7189f7e0">serial_in_head</a>, <a class="code" href="globals_8c.html#a4233c803dbb375f15303bade9f15c6e3">serial_in_tail</a>, ARRAYSIZE(serial_in_data), 0, 32, 32, 32);
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a11324f82208e497b8df7a49a58e7fbb6">VIEW_SERIAL_OUT_BUFFER</a>:
                        DrawCircularBuffer &lt;short, unsigned char&gt; 
                                (hwnd, hdc, <a class="code" href="globals_8c.html#ade0dbf38128704a39ac0db143f86c7a0">serial_out_data</a>, <a class="code" href="globals_8c.html#a72d12f1dff94819ba3eaf73b3fb014ae">serial_out_head</a>, <a class="code" href="globals_8c.html#a3b2536f1acd0ab0408c098957566ebdc">serial_out_tail</a>, ARRAYSIZE(serial_out_data), 0, 32, 32, 32);
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a89603d27be7b56fcccf3503f6a5db784">VIEW_OTHER</a>:
                {
                        <span class="comment">// Display the tickcount on view other</span>
                        <span class="keywordtype">char</span> buffer[512];
                        sprintf (buffer, <span class="stringliteral">&quot;TickCount: %u&quot;</span>, <a class="code" href="milestone4_2stdlib_8h.html#a29c77b2e37f549ed666615108111956e" title="Returns the system tick count.">GetSystemTickCount</a>());
                        ExtTextOut (hdc, 0, 40, 0, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, buffer, strlen (buffer), <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
                        <span class="keywordflow">break</span>;
                }
                }

                <span class="comment">// Write out the information of each PDB</span>
                <span class="comment">// This happens in every view</span>
                <span class="keywordtype">int</span> y = 400;
                <span class="keywordtype">char</span> buffer[512];
                <a class="code" href="structpdb.html">PDB</a> *<a class="code" href="structpdb.html">pdb</a> = <a class="code" href="globals_8c.html#a32c773383bd3fa3849068d16270b094f">pdb_First</a>;
                <span class="keywordtype">int</span> i = 2;
                <span class="keywordflow">while</span> (i-- &gt; 0)
                {
                        sprintf (buffer, <span class="stringliteral">&quot;PDB Name: %s Status: %c Reason %d&quot;</span>, pdb-&gt;<a class="code" href="structpdb.html#ad873facaaf26046b4217207b7f5d4d5a">ApplicationName</a>, 
                                pdb-&gt;<a class="code" href="structpdb.html#aff97a87345038b6d69b0a6de1f6efdf5">Status</a>, pdb-&gt;<a class="code" href="structpdb.html#adfb03271058360f2433c7ac6837ffc57">Reason</a>);
                        ExtTextOut (hdc, 0, y, 0, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, buffer, strlen (buffer), <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
                        y += 24;
                        pdb = pdb-&gt;<a class="code" href="structpdb.html#ae4dd6c64c219b91ad0db44e343fe8fa1">NextPDB</a>;
                }

                EndPaint (hwnd, &amp;ps);
                <span class="keywordflow">return</span> 0;
        }
        <span class="keywordflow">case</span> WM_COMMAND:
                pData = (<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html">RTOSTESTDATA</a> *)GetWindowLong (hwnd, GWL_USERDATA);
                <span class="keywordflow">if</span> (pData == <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
                        <span class="keywordflow">return</span> -1;

                <span class="comment">// Handle radio button clicks and change</span>
                <span class="comment">// view panes accordingly</span>
                <span class="keywordflow">switch</span> (wParam)
                {
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#ac61efb76533bd87c354fffbe1a6e44e1afc6aa7a5b464208bcab0c3cfaa09fb6e">IDC_VIEW_KEYBOARD_BUFFER</a>:
                        pData-&gt;<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html#ac6f993d4502b5f7b2ac71f06722e1cf3">CurrentView</a> = <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a1db1b1b71327c43334aa45028c21d8a5">VIEW_KEYBOARD_BUFFER</a>;
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#ac61efb76533bd87c354fffbe1a6e44e1aa74066286ed9641eab043fe075bb2c1d">IDC_VIEW_SERIAL_IN_BUFFER</a>:
                        pData-&gt;<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html#ac6f993d4502b5f7b2ac71f06722e1cf3">CurrentView</a> = <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a2295642dfec0aeb91008f49d2b974740">VIEW_SERIAL_IN_BUFFER</a>;
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#ac61efb76533bd87c354fffbe1a6e44e1a5db5a0630eb0374dd309eb646a759987">IDC_VIEW_SERIAL_OUT_BUFFER</a>:
                        pData-&gt;<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html#ac6f993d4502b5f7b2ac71f06722e1cf3">CurrentView</a> = <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a11324f82208e497b8df7a49a58e7fbb6">VIEW_SERIAL_OUT_BUFFER</a>;
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#ac61efb76533bd87c354fffbe1a6e44e1a0af8939378a9da321a1ee58758b2a474">IDC_VIEW_OTHER</a>:
                        pData-&gt;<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html#ac6f993d4502b5f7b2ac71f06722e1cf3">CurrentView</a> = <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a89603d27be7b56fcccf3503f6a5db784">VIEW_OTHER</a>;
                        <span class="keywordflow">break</span>;
                }
                
                <span class="comment">// SetFocus to the window (not the radio buttons)</span>
                <span class="comment">// and redraw everything</span>
                SetFocus (hwnd);
                InvalidateRect (hwnd, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="milestone4_2shared_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);

                <span class="keywordflow">return</span> 0;

        <span class="keywordflow">case</span> WM_TIMER:
                pData = (<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html">RTOSTESTDATA</a> *)GetWindowLong (hwnd, GWL_USERDATA);
                <span class="keywordflow">if</span> (pData == <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
                        <span class="keywordflow">return</span> -1;

                <span class="comment">// Handle our timers</span>
                <span class="keywordflow">switch</span> (wParam)
                {
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a5495990a5f1b6839399e691a33d9f757ab6cfc839eb7b0c2dd591bd9aa7b7e224">IDT_INTERRUPT_DEBUG_OUT</a>:
                        <span class="comment">// Fire off the DebugOutputInterrupt</span>
                        <a class="code" href="_r_t_o_s4_2rtos_8h.html#ac87223c05122352373be365f1c25cb94" title="Fired on debugging input.">DebugOutputInterrupt</a> ();
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a5495990a5f1b6839399e691a33d9f757a26ba5ac9a1a265fd892605a843734693">IDT_INTERRUPT_7</a>:
                        <span class="comment">// Redraw the screen and execute the Interrupt 7 handler</span>
                        <span class="comment">// (RoundRobinScheduler)</span>
                        InvalidateRect (hwnd, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="milestone4_2shared_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);

                        <a class="code" href="globals_8c.html#a5092bbc9e04487b450e965e9ac6d9bec">gTickCount</a>++;
                        <a class="code" href="milestone4_2rtos_8h.html#a26c5af6bb9bd7e1b4acc69cc24d3846f" title="Robin round scheduler.">RoundRobinScheduler</a> ();
                        <span class="keywordflow">break</span>;
                }
                <span class="keywordflow">break</span>;
        
        <span class="keywordflow">case</span> WM_KEYDOWN:
                pData = (<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html">RTOSTESTDATA</a> *)GetWindowLong (hwnd, GWL_USERDATA);
                <span class="keywordflow">if</span> (pData == <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
                        <span class="keywordflow">return</span> -1;

                <span class="comment">// Handle keydowns on a per window pane basis</span>
                <span class="keywordflow">switch</span> (pData-&gt;<a class="code" href="struct_r_t_o_s_t_e_s_t_d_a_t_a.html#ac6f993d4502b5f7b2ac71f06722e1cf3">CurrentView</a>)
                {
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a1db1b1b71327c43334aa45028c21d8a5">VIEW_KEYBOARD_BUFFER</a>:
                        <span class="keywordflow">if</span> (wParam == VK_DELETE)
                        {
                                <a class="code" href="milestone4_2stdlib_8h.html#a7817d415402167748e83272c1f9056b1" title="Get the next available keyboard character from the system&amp;#39;s keyboard buffer. This function will b...">InputKeyboardCharacter</a>();
                        }
                        <span class="keywordflow">else</span>
                        {
                                keyboard_data[keyboard_tail++] = wParam;
                        }
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a2295642dfec0aeb91008f49d2b974740">VIEW_SERIAL_IN_BUFFER</a>:
                        <span class="keywordflow">if</span> (wParam == VK_DELETE)
                        {
                                <a class="code" href="milestone4_2stdlib_8h.html#a7f996077ec6e319cfa3cc4aea7444e49" title="Get the next available character from the system&amp;#39;s debugging buffer. This function will block if ...">InputDebugCharacter</a>();
                        }
                        <span class="keywordflow">else</span>
                        {
                                serial_in_data[serial_in_tail++] = wParam;
                        }
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a11324f82208e497b8df7a49a58e7fbb6">VIEW_SERIAL_OUT_BUFFER</a>:
                        <a class="code" href="milestone4_2stdlib_8h.html#ae046b1cc0c83cc7d54d00ee16687065e" title="Output a character to the system&amp;#39;s debugging device.">OutputDebugCharacter</a> (wParam);
                        <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> <a class="code" href="global__const_8h.html#a4ac517869a56fbadbcf1cac6c8d10a33a89603d27be7b56fcccf3503f6a5db784">VIEW_OTHER</a>:

                        <span class="keywordflow">break</span>;
                }

                InvalidateRect (hwnd, <a class="code" href="milestone4_2shared_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="milestone4_2shared_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
                <span class="keywordflow">return</span> 0;

        <span class="keywordflow">case</span> WM_CLOSE:
                <span class="comment">// Ask the user if they wish to exit</span>
                <span class="keywordflow">if</span> (MessageBox (hwnd, <a class="code" href="global__const_8cpp.html#a9e5957754fbd9e4c67d83e93542db2c5">SureExit</a>,
                        szTitle, MB_ICONSTOP | MB_YESNO) == IDYES) 
                {
                        DestroyWindow (hwnd);
                }
                <span class="keywordflow">return</span> 0;

        <span class="keywordflow">case</span> WM_DESTROY:
                <span class="comment">// Cleanup our timers</span>
                KillTimer (hwnd, <a class="code" href="global__const_8h.html#a5495990a5f1b6839399e691a33d9f757ab6cfc839eb7b0c2dd591bd9aa7b7e224">IDT_INTERRUPT_DEBUG_OUT</a>);
                KillTimer (hwnd, <a class="code" href="global__const_8h.html#a5495990a5f1b6839399e691a33d9f757a26ba5ac9a1a265fd892605a843734693">IDT_INTERRUPT_7</a>);
                PostQuitMessage (0);
                <span class="keywordflow">return</span> 0;
        }

        <span class="keywordflow">return</span> DefWindowProc (hwnd, message, wParam, lParam);
}
</pre></div>
</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Dec 15 2010 09:42:37 for RTOS 4 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
